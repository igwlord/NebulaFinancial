<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEBUG CALENDAR - Diagn√≥stico Espec√≠fico</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #1a1a2e; color: white; }
        .debug-section { background: #16213e; padding: 20px; margin: 15px 0; border-radius: 10px; }
        .error { background: #dc2626; }
        .success { background: #059669; }
        .warning { background: #d97706; }
        pre { background: #0f172a; padding: 10px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîç DEBUG CALENDAR - Diagn√≥stico Espec√≠fico</h1>
    
    <div class="debug-section">
        <h3>üìä Estado del DOM</h3>
        <div id="dom-status">Verificando...</div>
    </div>

    <div class="debug-section">
        <h3>üéØ B√∫squeda de Elementos</h3>
        <div id="element-search">Buscando elementos...</div>
    </div>

    <div class="debug-section">
        <h3>üìù C√≥digo HTML Actual</h3>
        <div id="html-content">Extrayendo...</div>
    </div>

    <script>
        console.log('üîç DEBUG: Iniciando diagn√≥stico del calendario...');
        
        // Simular AppState b√°sico para las pruebas
        window.appState = {
            calendarViewYear: 2025,
            theme: {
                textPrimary: 'text-white',
                textSecondary: 'text-gray-300',
                accent: 'text-yellow-400'
            }
        };

        function updateDOMStatus() {
            const domStatus = document.getElementById('dom-status');
            let status = '';
            
            // Verificar si existe el elemento del calendario
            const calendarElement = document.getElementById('calendar-year-input');
            status += `<p><strong>calendar-year-input:</strong> ${calendarElement ? '‚úÖ ENCONTRADO' : '‚ùå NO ENCONTRADO'}</p>`;
            
            // Buscar cualquier elemento que contenga "calendar"
            const allElements = document.querySelectorAll('*[id*="calendar"], *[class*="calendar"]');
            status += `<p><strong>Elementos con "calendar":</strong> ${allElements.length} encontrados</p>`;
            
            // Buscar cualquier input de tipo number
            const numberInputs = document.querySelectorAll('input[type="number"]');
            status += `<p><strong>Inputs num√©ricos:</strong> ${numberInputs.length} encontrados</p>`;
            
            domStatus.innerHTML = status;
        }

        function searchElements() {
            const searchDiv = document.getElementById('element-search');
            let results = '';
            
            // Buscar en el HTML actual por texto espec√≠fico
            const htmlContent = document.documentElement.outerHTML;
            
            const searches = [
                'calendar-year-input',
                'type="number"',
                'A√±o:',
                'meses con datos',
                'aria-label="A√±o del calendario"'
            ];
            
            searches.forEach(search => {
                const found = htmlContent.includes(search);
                results += `<p><strong>"${search}":</strong> ${found ? '‚úÖ ENCONTRADO' : '‚ùå NO ENCONTRADO'}</p>`;
            });
            
            searchDiv.innerHTML = results;
        }

        function extractHTML() {
            const htmlDiv = document.getElementById('html-content');
            
            // Intentar obtener el HTML desde la app principal
            fetch('http://127.0.0.1:8081/index-lab.html?t=' + Date.now())
                .then(response => response.text())
                .then(html => {
                    const calendarMatch = html.match(/calendar-year-input.*?>/);
                    if (calendarMatch) {
                        htmlDiv.innerHTML = `<div class="success"><h4>‚úÖ SELECTOR DE A√ëOS ENCONTRADO EN EL ARCHIVO:</h4><pre>${calendarMatch[0]}</pre></div>`;
                    } else {
                        htmlDiv.innerHTML = `<div class="error"><h4>‚ùå SELECTOR DE A√ëOS NO ENCONTRADO EN EL ARCHIVO</h4></div>`;
                    }
                })
                .catch(error => {
                    htmlDiv.innerHTML = `<div class="error"><h4>‚ùå Error al cargar el archivo:</h4><pre>${error}</pre></div>`;
                });
        }

        // Ejecutar diagn√≥sticos
        setTimeout(() => {
            updateDOMStatus();
            searchElements();
            extractHTML();
        }, 1000);

        // Verificar cada 2 segundos
        setInterval(() => {
            updateDOMStatus();
        }, 2000);
    </script>
</body>
</html>
